<UserControl x:Class="Module7.Views.M7"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:Module7.Views"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="822.648" d:DesignWidth="704.53"
             xmlns:prism="http://prismlibrary.com/"
             prism:ViewModelLocator.AutoWireViewModel="True" >
    <Grid Background="#FFEEF7FF">
        <TextBlock Text="{Binding Message}"
                       HorizontalAlignment="Right"
                       VerticalAlignment="Top" Margin="0,5,25,0" Width="60" />
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Margin="5">
            <TextBox TextWrapping="Wrap" Text="★ウインドウ位置保存&#xD;&#xA;アプリ終了時にウインドウの位置を保存しておき、次回起動時に再現します。&#xD;&#xA;&#xD;&#xA;&#xA;    public partial class MainWindow : Window&#xD;&#xA;    {&#xD;&#xA;        public MainWindow()&#xD;&#xA;        {&#xD;&#xA;            InitializeComponent();&#xD;&#xA;            SetWindowPosition();&#xD;&#xA;        }&#xD;&#xA;&#xD;&#xA;        // Setting.settingsに修飾子publicスコープユーザーで下記項目を作成&#xD;&#xA;        // WindowLeft       double  ユーザー    0.0&#xD;&#xA;        // WindowTop        double  ユーザー    0.0&#xD;&#xA;        // WindowWidth      double  ユーザー    800.0&#xD;&#xA;        // WindowHeight     double  ユーザー    600.0&#xD;&#xA;        // WindowMaximized  double  ユーザー    false&#xD;&#xA;&#xD;&#xA;        // ViewでClosingをダブルクリックしてイベントハンドラーWindow_Closingを作成して書く&#xD;&#xA;&#xD;&#xA;        /// &lt;summary&gt;&#xD;&#xA;        /// 画面を閉じる時の処理&#xD;&#xA;        /// &lt;/summary&gt;&#xD;&#xA;        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;&#xD;&#xA;        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;&#xD;&#xA;        private void Window_Closing(object sender, System.ComponentModel.CancelEventArgs e)&#xD;&#xA;        {&#xD;&#xA;            var settings = Properties.Settings.Default;&#xD;&#xA;            settings.WindowMaximized = (WindowState == WindowState.Maximized);&#xD;&#xA;            WindowState = WindowState.Normal; // 最大化解除&#xD;&#xA;            settings.WindowLeft = Left;&#xD;&#xA;            settings.WindowTop = Top;&#xD;&#xA;            settings.WindowWidth = Width;&#xD;&#xA;            settings.WindowHeight = Height;&#xD;&#xA;            settings.Save();&#xD;&#xA;        }&#xD;&#xA;&#xD;&#xA;        /// &lt;summary&gt;&#xD;&#xA;        /// 画面の位置・サイズの復元&#xD;&#xA;        /// &lt;/summary&gt;&#xD;&#xA;        void SetWindowPosition()&#xD;&#xA;        {&#xD;&#xA;            var settings = Properties.Settings.Default;&#xD;&#xA;&#xD;&#xA;            if (settings.WindowLeft &gt;= 0 &amp;&amp;&#xD;&#xA;                (settings.WindowLeft + settings.WindowWidth) &lt; SystemParameters.VirtualScreenWidth)&#xD;&#xA;            { Left = settings.WindowLeft; }&#xD;&#xA;&#xD;&#xA;            if (settings.WindowTop &gt;= 0 &amp;&amp;&#xD;&#xA;                (settings.WindowTop + settings.WindowHeight) &lt; SystemParameters.VirtualScreenHeight)&#xD;&#xA;            { Top = settings.WindowTop; }&#xD;&#xA;&#xD;&#xA;            if (settings.WindowWidth &gt; 0 &amp;&amp;&#xD;&#xA;                settings.WindowWidth &lt;= SystemParameters.WorkArea.Width)&#xD;&#xA;            { Width = settings.WindowWidth; }&#xD;&#xA;&#xD;&#xA;            if (settings.WindowHeight &gt; 0 &amp;&amp;&#xD;&#xA;                settings.WindowHeight &lt;= SystemParameters.WorkArea.Height)&#xD;&#xA;            { Height = settings.WindowHeight; }&#xD;&#xA;&#xD;&#xA;            if (settings.WindowMaximized)&#xD;&#xA;            {&#xD;&#xA;                Loaded += (o, e) =&gt; WindowState = WindowState.Maximized;&#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;    }" IsReadOnly="True" Background="{x:Null}" BorderThickness="0"/>
        </ScrollViewer>
    </Grid>
</UserControl>
